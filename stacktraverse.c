#define _GNU_SOURCE

#include <stddef.h>

#include "stacktraverse.h"

void *
getreturnaddr(int level)
{

    switch(level) {
    case 0: return __builtin_return_address(1);
    case 1: return __builtin_return_address(2);
    case 2: return __builtin_return_address(3);
    case 3: return __builtin_return_address(4);
    case 4: return __builtin_return_address(5);
    case 5: return __builtin_return_address(6);
    case 6: return __builtin_return_address(7);
    case 7: return __builtin_return_address(8);
    case 8: return __builtin_return_address(9);
    case 9: return __builtin_return_address(10);
    case 10: return __builtin_return_address(11);
    case 11: return __builtin_return_address(12);
    case 12: return __builtin_return_address(13);
    case 13: return __builtin_return_address(14);
    case 14: return __builtin_return_address(15);
    case 15: return __builtin_return_address(16);
    case 16: return __builtin_return_address(17);
    case 17: return __builtin_return_address(18);
    case 18: return __builtin_return_address(19);
    case 19: return __builtin_return_address(20);
    case 20: return __builtin_return_address(21);
    case 21: return __builtin_return_address(22);
    case 22: return __builtin_return_address(23);
    case 23: return __builtin_return_address(24);
    case 24: return __builtin_return_address(25);
    case 25: return __builtin_return_address(26);
    case 26: return __builtin_return_address(27);
    case 27: return __builtin_return_address(28);
    case 28: return __builtin_return_address(29);
    case 29: return __builtin_return_address(30);
    case 30: return __builtin_return_address(31);
    case 31: return __builtin_return_address(32);
    case 32: return __builtin_return_address(33);
    case 33: return __builtin_return_address(34);
    case 34: return __builtin_return_address(35);
    case 35: return __builtin_return_address(36);
    case 36: return __builtin_return_address(37);
    case 37: return __builtin_return_address(38);
    case 38: return __builtin_return_address(39);
    case 39: return __builtin_return_address(40);
    case 40: return __builtin_return_address(41);
    case 41: return __builtin_return_address(42);
    case 42: return __builtin_return_address(43);
    case 43: return __builtin_return_address(44);
    case 44: return __builtin_return_address(45);
    case 45: return __builtin_return_address(46);
    case 46: return __builtin_return_address(47);
    case 47: return __builtin_return_address(48);
    case 48: return __builtin_return_address(49);
    case 49: return __builtin_return_address(50);
    case 50: return __builtin_return_address(51);
    case 51: return __builtin_return_address(52);
    case 52: return __builtin_return_address(53);
    case 53: return __builtin_return_address(54);
    case 54: return __builtin_return_address(55);
    case 55: return __builtin_return_address(56);
    case 56: return __builtin_return_address(57);
    case 57: return __builtin_return_address(58);
    case 58: return __builtin_return_address(59);
    case 59: return __builtin_return_address(60);
    case 60: return __builtin_return_address(61);
    case 61: return __builtin_return_address(62);
    case 62: return __builtin_return_address(63);
    case 63: return __builtin_return_address(64);
    case 64: return __builtin_return_address(65);
    case 65: return __builtin_return_address(66);
    case 66: return __builtin_return_address(67);
    case 67: return __builtin_return_address(68);
    case 68: return __builtin_return_address(69);
    case 69: return __builtin_return_address(70);
    case 70: return __builtin_return_address(71);
    case 71: return __builtin_return_address(72);
    case 72: return __builtin_return_address(73);
    case 73: return __builtin_return_address(74);
    case 74: return __builtin_return_address(75);
    case 75: return __builtin_return_address(76);
    case 76: return __builtin_return_address(77);
    case 77: return __builtin_return_address(78);
    case 78: return __builtin_return_address(79);
    case 79: return __builtin_return_address(80);
    case 80: return __builtin_return_address(81);
    case 81: return __builtin_return_address(82);
    case 82: return __builtin_return_address(83);
    case 83: return __builtin_return_address(84);
    case 84: return __builtin_return_address(85);
    case 85: return __builtin_return_address(86);
    case 86: return __builtin_return_address(87);
    case 87: return __builtin_return_address(88);
    case 88: return __builtin_return_address(89);
    case 89: return __builtin_return_address(90);
    case 90: return __builtin_return_address(91);
    case 91: return __builtin_return_address(92);
    case 92: return __builtin_return_address(93);
    case 93: return __builtin_return_address(94);
    case 94: return __builtin_return_address(95);
    case 95: return __builtin_return_address(96);
    case 96: return __builtin_return_address(97);
    case 97: return __builtin_return_address(98);
    case 98: return __builtin_return_address(99);
    case 99: return __builtin_return_address(100);
    case 100: return __builtin_return_address(101);
    case 101: return __builtin_return_address(102);
    case 102: return __builtin_return_address(103);
    case 103: return __builtin_return_address(104);
    case 104: return __builtin_return_address(105);
    case 105: return __builtin_return_address(106);
    case 106: return __builtin_return_address(107);
    case 107: return __builtin_return_address(108);
    case 108: return __builtin_return_address(109);
    case 109: return __builtin_return_address(110);
    case 110: return __builtin_return_address(111);
    case 111: return __builtin_return_address(112);
    case 112: return __builtin_return_address(113);
    case 113: return __builtin_return_address(114);
    case 114: return __builtin_return_address(115);
    case 115: return __builtin_return_address(116);
    case 116: return __builtin_return_address(117);
    case 117: return __builtin_return_address(118);
    case 118: return __builtin_return_address(119);
    case 119: return __builtin_return_address(120);
    case 120: return __builtin_return_address(121);
    case 121: return __builtin_return_address(122);
    case 122: return __builtin_return_address(123);
    case 123: return __builtin_return_address(124);
    case 124: return __builtin_return_address(125);
    case 125: return __builtin_return_address(126);
    case 126: return __builtin_return_address(127);
    case 127: return __builtin_return_address(128);
    case 128: return __builtin_return_address(129);
    case 129: return __builtin_return_address(130);
    case 130: return __builtin_return_address(131);
    case 131: return __builtin_return_address(132);
    case 132: return __builtin_return_address(133);
    case 133: return __builtin_return_address(134);
    case 134: return __builtin_return_address(135);
    case 135: return __builtin_return_address(136);
    case 136: return __builtin_return_address(137);
    case 137: return __builtin_return_address(138);
    case 138: return __builtin_return_address(139);
    case 139: return __builtin_return_address(140);
    case 140: return __builtin_return_address(141);
    case 141: return __builtin_return_address(142);
    case 142: return __builtin_return_address(143);
    case 143: return __builtin_return_address(144);
    case 144: return __builtin_return_address(145);
    case 145: return __builtin_return_address(146);
    case 146: return __builtin_return_address(147);
    case 147: return __builtin_return_address(148);
    case 148: return __builtin_return_address(149);
    case 149: return __builtin_return_address(150);
    case 150: return __builtin_return_address(151);
    case 151: return __builtin_return_address(152);
    case 152: return __builtin_return_address(153);
    case 153: return __builtin_return_address(154);
    case 154: return __builtin_return_address(155);
    case 155: return __builtin_return_address(156);
    case 156: return __builtin_return_address(157);
    case 157: return __builtin_return_address(158);
    case 158: return __builtin_return_address(159);
    case 159: return __builtin_return_address(160);
    case 160: return __builtin_return_address(161);
    case 161: return __builtin_return_address(162);
    case 162: return __builtin_return_address(163);
    case 163: return __builtin_return_address(164);
    case 164: return __builtin_return_address(165);
    case 165: return __builtin_return_address(166);
    case 166: return __builtin_return_address(167);
    case 167: return __builtin_return_address(168);
    case 168: return __builtin_return_address(169);
    case 169: return __builtin_return_address(170);
    case 170: return __builtin_return_address(171);
    case 171: return __builtin_return_address(172);
    case 172: return __builtin_return_address(173);
    case 173: return __builtin_return_address(174);
    case 174: return __builtin_return_address(175);
    case 175: return __builtin_return_address(176);
    case 176: return __builtin_return_address(177);
    case 177: return __builtin_return_address(178);
    case 178: return __builtin_return_address(179);
    case 179: return __builtin_return_address(180);
    case 180: return __builtin_return_address(181);
    case 181: return __builtin_return_address(182);
    case 182: return __builtin_return_address(183);
    case 183: return __builtin_return_address(184);
    case 184: return __builtin_return_address(185);
    case 185: return __builtin_return_address(186);
    case 186: return __builtin_return_address(187);
    case 187: return __builtin_return_address(188);
    case 188: return __builtin_return_address(189);
    case 189: return __builtin_return_address(190);
    case 190: return __builtin_return_address(191);
    case 191: return __builtin_return_address(192);
    case 192: return __builtin_return_address(193);
    case 193: return __builtin_return_address(194);
    case 194: return __builtin_return_address(195);
    case 195: return __builtin_return_address(196);
    case 196: return __builtin_return_address(197);
    case 197: return __builtin_return_address(198);
    case 198: return __builtin_return_address(199);
    case 199: return __builtin_return_address(200);
    case 200: return __builtin_return_address(201);
    case 201: return __builtin_return_address(202);
    case 202: return __builtin_return_address(203);
    case 203: return __builtin_return_address(204);
    case 204: return __builtin_return_address(205);
    case 205: return __builtin_return_address(206);
    case 206: return __builtin_return_address(207);
    case 207: return __builtin_return_address(208);
    case 208: return __builtin_return_address(209);
    case 209: return __builtin_return_address(210);
    case 210: return __builtin_return_address(211);
    case 211: return __builtin_return_address(212);
    case 212: return __builtin_return_address(213);
    case 213: return __builtin_return_address(214);
    case 214: return __builtin_return_address(215);
    case 215: return __builtin_return_address(216);
    case 216: return __builtin_return_address(217);
    case 217: return __builtin_return_address(218);
    case 218: return __builtin_return_address(219);
    case 219: return __builtin_return_address(220);
    case 220: return __builtin_return_address(221);
    case 221: return __builtin_return_address(222);
    case 222: return __builtin_return_address(223);
    case 223: return __builtin_return_address(224);
    case 224: return __builtin_return_address(225);
    case 225: return __builtin_return_address(226);
    case 226: return __builtin_return_address(227);
    case 227: return __builtin_return_address(228);
    case 228: return __builtin_return_address(229);
    case 229: return __builtin_return_address(230);
    case 230: return __builtin_return_address(231);
    case 231: return __builtin_return_address(232);
    case 232: return __builtin_return_address(233);
    case 233: return __builtin_return_address(234);
    case 234: return __builtin_return_address(235);
    case 235: return __builtin_return_address(236);
    case 236: return __builtin_return_address(237);
    case 237: return __builtin_return_address(238);
    case 238: return __builtin_return_address(239);
    case 239: return __builtin_return_address(240);
    case 240: return __builtin_return_address(241);
    case 241: return __builtin_return_address(242);
    case 242: return __builtin_return_address(243);
    case 243: return __builtin_return_address(244);
    case 244: return __builtin_return_address(245);
    case 245: return __builtin_return_address(246);
    case 246: return __builtin_return_address(247);
    case 247: return __builtin_return_address(248);
    case 248: return __builtin_return_address(249);
    case 249: return __builtin_return_address(250);
    case 250: return __builtin_return_address(251);
    case 251: return __builtin_return_address(252);
    case 252: return __builtin_return_address(253);
    case 253: return __builtin_return_address(254);
    case 254: return __builtin_return_address(255);
    case 255: return __builtin_return_address(256);
    default: return NULL;
    }
}


void *
getframeaddr(int level)
{

    switch(level) {
    case 0: return __builtin_frame_address(1);
    case 1: return __builtin_frame_address(2);
    case 2: return __builtin_frame_address(3);
    case 3: return __builtin_frame_address(4);
    case 4: return __builtin_frame_address(5);
    case 5: return __builtin_frame_address(6);
    case 6: return __builtin_frame_address(7);
    case 7: return __builtin_frame_address(8);
    case 8: return __builtin_frame_address(9);
    case 9: return __builtin_frame_address(10);
    case 10: return __builtin_frame_address(11);
    case 11: return __builtin_frame_address(12);
    case 12: return __builtin_frame_address(13);
    case 13: return __builtin_frame_address(14);
    case 14: return __builtin_frame_address(15);
    case 15: return __builtin_frame_address(16);
    case 16: return __builtin_frame_address(17);
    case 17: return __builtin_frame_address(18);
    case 18: return __builtin_frame_address(19);
    case 19: return __builtin_frame_address(20);
    case 20: return __builtin_frame_address(21);
    case 21: return __builtin_frame_address(22);
    case 22: return __builtin_frame_address(23);
    case 23: return __builtin_frame_address(24);
    case 24: return __builtin_frame_address(25);
    case 25: return __builtin_frame_address(26);
    case 26: return __builtin_frame_address(27);
    case 27: return __builtin_frame_address(28);
    case 28: return __builtin_frame_address(29);
    case 29: return __builtin_frame_address(30);
    case 30: return __builtin_frame_address(31);
    case 31: return __builtin_frame_address(32);
    case 32: return __builtin_frame_address(33);
    case 33: return __builtin_frame_address(34);
    case 34: return __builtin_frame_address(35);
    case 35: return __builtin_frame_address(36);
    case 36: return __builtin_frame_address(37);
    case 37: return __builtin_frame_address(38);
    case 38: return __builtin_frame_address(39);
    case 39: return __builtin_frame_address(40);
    case 40: return __builtin_frame_address(41);
    case 41: return __builtin_frame_address(42);
    case 42: return __builtin_frame_address(43);
    case 43: return __builtin_frame_address(44);
    case 44: return __builtin_frame_address(45);
    case 45: return __builtin_frame_address(46);
    case 46: return __builtin_frame_address(47);
    case 47: return __builtin_frame_address(48);
    case 48: return __builtin_frame_address(49);
    case 49: return __builtin_frame_address(50);
    case 50: return __builtin_frame_address(51);
    case 51: return __builtin_frame_address(52);
    case 52: return __builtin_frame_address(53);
    case 53: return __builtin_frame_address(54);
    case 54: return __builtin_frame_address(55);
    case 55: return __builtin_frame_address(56);
    case 56: return __builtin_frame_address(57);
    case 57: return __builtin_frame_address(58);
    case 58: return __builtin_frame_address(59);
    case 59: return __builtin_frame_address(60);
    case 60: return __builtin_frame_address(61);
    case 61: return __builtin_frame_address(62);
    case 62: return __builtin_frame_address(63);
    case 63: return __builtin_frame_address(64);
    case 64: return __builtin_frame_address(65);
    case 65: return __builtin_frame_address(66);
    case 66: return __builtin_frame_address(67);
    case 67: return __builtin_frame_address(68);
    case 68: return __builtin_frame_address(69);
    case 69: return __builtin_frame_address(70);
    case 70: return __builtin_frame_address(71);
    case 71: return __builtin_frame_address(72);
    case 72: return __builtin_frame_address(73);
    case 73: return __builtin_frame_address(74);
    case 74: return __builtin_frame_address(75);
    case 75: return __builtin_frame_address(76);
    case 76: return __builtin_frame_address(77);
    case 77: return __builtin_frame_address(78);
    case 78: return __builtin_frame_address(79);
    case 79: return __builtin_frame_address(80);
    case 80: return __builtin_frame_address(81);
    case 81: return __builtin_frame_address(82);
    case 82: return __builtin_frame_address(83);
    case 83: return __builtin_frame_address(84);
    case 84: return __builtin_frame_address(85);
    case 85: return __builtin_frame_address(86);
    case 86: return __builtin_frame_address(87);
    case 87: return __builtin_frame_address(88);
    case 88: return __builtin_frame_address(89);
    case 89: return __builtin_frame_address(90);
    case 90: return __builtin_frame_address(91);
    case 91: return __builtin_frame_address(92);
    case 92: return __builtin_frame_address(93);
    case 93: return __builtin_frame_address(94);
    case 94: return __builtin_frame_address(95);
    case 95: return __builtin_frame_address(96);
    case 96: return __builtin_frame_address(97);
    case 97: return __builtin_frame_address(98);
    case 98: return __builtin_frame_address(99);
    case 99: return __builtin_frame_address(100);
    case 100: return __builtin_frame_address(101);
    case 101: return __builtin_frame_address(102);
    case 102: return __builtin_frame_address(103);
    case 103: return __builtin_frame_address(104);
    case 104: return __builtin_frame_address(105);
    case 105: return __builtin_frame_address(106);
    case 106: return __builtin_frame_address(107);
    case 107: return __builtin_frame_address(108);
    case 108: return __builtin_frame_address(109);
    case 109: return __builtin_frame_address(110);
    case 110: return __builtin_frame_address(111);
    case 111: return __builtin_frame_address(112);
    case 112: return __builtin_frame_address(113);
    case 113: return __builtin_frame_address(114);
    case 114: return __builtin_frame_address(115);
    case 115: return __builtin_frame_address(116);
    case 116: return __builtin_frame_address(117);
    case 117: return __builtin_frame_address(118);
    case 118: return __builtin_frame_address(119);
    case 119: return __builtin_frame_address(120);
    case 120: return __builtin_frame_address(121);
    case 121: return __builtin_frame_address(122);
    case 122: return __builtin_frame_address(123);
    case 123: return __builtin_frame_address(124);
    case 124: return __builtin_frame_address(125);
    case 125: return __builtin_frame_address(126);
    case 126: return __builtin_frame_address(127);
    case 127: return __builtin_frame_address(128);
    case 128: return __builtin_frame_address(129);
    case 129: return __builtin_frame_address(130);
    case 130: return __builtin_frame_address(131);
    case 131: return __builtin_frame_address(132);
    case 132: return __builtin_frame_address(133);
    case 133: return __builtin_frame_address(134);
    case 134: return __builtin_frame_address(135);
    case 135: return __builtin_frame_address(136);
    case 136: return __builtin_frame_address(137);
    case 137: return __builtin_frame_address(138);
    case 138: return __builtin_frame_address(139);
    case 139: return __builtin_frame_address(140);
    case 140: return __builtin_frame_address(141);
    case 141: return __builtin_frame_address(142);
    case 142: return __builtin_frame_address(143);
    case 143: return __builtin_frame_address(144);
    case 144: return __builtin_frame_address(145);
    case 145: return __builtin_frame_address(146);
    case 146: return __builtin_frame_address(147);
    case 147: return __builtin_frame_address(148);
    case 148: return __builtin_frame_address(149);
    case 149: return __builtin_frame_address(150);
    case 150: return __builtin_frame_address(151);
    case 151: return __builtin_frame_address(152);
    case 152: return __builtin_frame_address(153);
    case 153: return __builtin_frame_address(154);
    case 154: return __builtin_frame_address(155);
    case 155: return __builtin_frame_address(156);
    case 156: return __builtin_frame_address(157);
    case 157: return __builtin_frame_address(158);
    case 158: return __builtin_frame_address(159);
    case 159: return __builtin_frame_address(160);
    case 160: return __builtin_frame_address(161);
    case 161: return __builtin_frame_address(162);
    case 162: return __builtin_frame_address(163);
    case 163: return __builtin_frame_address(164);
    case 164: return __builtin_frame_address(165);
    case 165: return __builtin_frame_address(166);
    case 166: return __builtin_frame_address(167);
    case 167: return __builtin_frame_address(168);
    case 168: return __builtin_frame_address(169);
    case 169: return __builtin_frame_address(170);
    case 170: return __builtin_frame_address(171);
    case 171: return __builtin_frame_address(172);
    case 172: return __builtin_frame_address(173);
    case 173: return __builtin_frame_address(174);
    case 174: return __builtin_frame_address(175);
    case 175: return __builtin_frame_address(176);
    case 176: return __builtin_frame_address(177);
    case 177: return __builtin_frame_address(178);
    case 178: return __builtin_frame_address(179);
    case 179: return __builtin_frame_address(180);
    case 180: return __builtin_frame_address(181);
    case 181: return __builtin_frame_address(182);
    case 182: return __builtin_frame_address(183);
    case 183: return __builtin_frame_address(184);
    case 184: return __builtin_frame_address(185);
    case 185: return __builtin_frame_address(186);
    case 186: return __builtin_frame_address(187);
    case 187: return __builtin_frame_address(188);
    case 188: return __builtin_frame_address(189);
    case 189: return __builtin_frame_address(190);
    case 190: return __builtin_frame_address(191);
    case 191: return __builtin_frame_address(192);
    case 192: return __builtin_frame_address(193);
    case 193: return __builtin_frame_address(194);
    case 194: return __builtin_frame_address(195);
    case 195: return __builtin_frame_address(196);
    case 196: return __builtin_frame_address(197);
    case 197: return __builtin_frame_address(198);
    case 198: return __builtin_frame_address(199);
    case 199: return __builtin_frame_address(200);
    case 200: return __builtin_frame_address(201);
    case 201: return __builtin_frame_address(202);
    case 202: return __builtin_frame_address(203);
    case 203: return __builtin_frame_address(204);
    case 204: return __builtin_frame_address(205);
    case 205: return __builtin_frame_address(206);
    case 206: return __builtin_frame_address(207);
    case 207: return __builtin_frame_address(208);
    case 208: return __builtin_frame_address(209);
    case 209: return __builtin_frame_address(210);
    case 210: return __builtin_frame_address(211);
    case 211: return __builtin_frame_address(212);
    case 212: return __builtin_frame_address(213);
    case 213: return __builtin_frame_address(214);
    case 214: return __builtin_frame_address(215);
    case 215: return __builtin_frame_address(216);
    case 216: return __builtin_frame_address(217);
    case 217: return __builtin_frame_address(218);
    case 218: return __builtin_frame_address(219);
    case 219: return __builtin_frame_address(220);
    case 220: return __builtin_frame_address(221);
    case 221: return __builtin_frame_address(222);
    case 222: return __builtin_frame_address(223);
    case 223: return __builtin_frame_address(224);
    case 224: return __builtin_frame_address(225);
    case 225: return __builtin_frame_address(226);
    case 226: return __builtin_frame_address(227);
    case 227: return __builtin_frame_address(228);
    case 228: return __builtin_frame_address(229);
    case 229: return __builtin_frame_address(230);
    case 230: return __builtin_frame_address(231);
    case 231: return __builtin_frame_address(232);
    case 232: return __builtin_frame_address(233);
    case 233: return __builtin_frame_address(234);
    case 234: return __builtin_frame_address(235);
    case 235: return __builtin_frame_address(236);
    case 236: return __builtin_frame_address(237);
    case 237: return __builtin_frame_address(238);
    case 238: return __builtin_frame_address(239);
    case 239: return __builtin_frame_address(240);
    case 240: return __builtin_frame_address(241);
    case 241: return __builtin_frame_address(242);
    case 242: return __builtin_frame_address(243);
    case 243: return __builtin_frame_address(244);
    case 244: return __builtin_frame_address(245);
    case 245: return __builtin_frame_address(246);
    case 246: return __builtin_frame_address(247);
    case 247: return __builtin_frame_address(248);
    case 248: return __builtin_frame_address(249);
    case 249: return __builtin_frame_address(250);
    case 250: return __builtin_frame_address(251);
    case 251: return __builtin_frame_address(252);
    case 252: return __builtin_frame_address(253);
    case 253: return __builtin_frame_address(254);
    case 254: return __builtin_frame_address(255);
    case 255: return __builtin_frame_address(256);
    default: return NULL;
    }
}
